#!/usr/bin/env ruby -w
# encoding: UTF-8
module M数据处理
  def self.线性相关系数(a1, a2)
    #|r|<0.4为低度线性相关；0.4≤|r|<0.7为显著性相关；0.7≤|r|<1为高度线性相关
    引发异常('数据处理异常','参数长度不等') if a1.大小 != a2.大小
    ∑XY = [a1, a2].转置.收集{|x, y| x * y}.注入(:+)
    ∑X, ∑X² = a1.注入(:+), a1.收集{|x| x**2}.注入(:+)
    ∑Y, ∑Y² = a2.注入(:+), a2.收集{|y| y**2}.注入(:+)
    n = a1.大小.浮点化
    分子 = ∑XY - (∑X * ∑Y) / n
    分母 = ((∑X² - ∑X**2 / n) * (∑Y² - ∑Y**2 / n)).开根
    分子 / 分母
  end
end